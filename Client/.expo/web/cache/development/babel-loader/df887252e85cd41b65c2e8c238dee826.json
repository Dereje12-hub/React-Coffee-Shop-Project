{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.spawnSudoAsync = exports.getPossibleProjectRoot = void 0;\n\nvar spawn_async_1 = __importDefault(require(\"@expo/spawn-async\"));\n\nvar fs_1 = require(\"fs\");\n\nvar sudo_prompt_1 = __importDefault(require(\"sudo-prompt\"));\n\nfunction getPossibleProjectRoot() {\n  return fs_1.realpathSync(process.cwd());\n}\n\nexports.getPossibleProjectRoot = getPossibleProjectRoot;\n\nfunction spawnSudoAsync(command, spawnOptions) {\n  return _regeneratorRuntime.async(function spawnSudoAsync$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          if (!(process.platform === 'win32')) {\n            _context.next = 4;\n            break;\n          }\n\n          return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n            sudo_prompt_1.default.exec(command.join(' '), {\n              name: 'pod install'\n            }, function (error) {\n              if (error) {\n                reject(error);\n              }\n\n              resolve();\n            });\n          }));\n\n        case 4:\n          console.log('Your password might be needed to install CocoaPods CLI: https://guides.cocoapods.org/using/getting-started.html#installation');\n          _context.next = 7;\n          return _regeneratorRuntime.awrap(spawn_async_1.default('sudo', command, spawnOptions));\n\n        case 7:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}\n\nexports.spawnSudoAsync = spawnSudoAsync;","map":{"version":3,"sources":["../src/PackageManager.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,IAAA,aAAA,GAAA,eAAA,CAAA,OAAA,CAAA,mBAAA,CAAA,CAAA;;AACA,IAAA,IAAA,GAAA,OAAA,CAAA,IAAA,CAAA;;AACA,IAAA,aAAA,GAAA,eAAA,CAAA,OAAA,CAAA,aAAA,CAAA,CAAA;;AAcA,SAAgB,sBAAhB,GAAsC;AACpC,SAAO,IAAA,CAAA,YAAA,CAAa,OAAO,CAAC,GAAR,EAAb,CAAP;AACD;;AAFD,OAAA,CAAA,sBAAA,GAAA,sBAAA;;AAIO,SAAe,cAAf,CAA8B,OAA9B,EAAiD,YAAjD;AAAA;AAAA;AAAA;AAAA;AAAA,gBAED,OAAO,CAAC,QAAR,KAAqB,OAFpB;AAAA;AAAA;AAAA;;AAAA,2CAGI,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAoB;AACrC,YAAA,aAAA,CAAA,OAAA,CAAK,IAAL,CAAU,OAAO,CAAC,IAAR,CAAa,GAAb,CAAV,EAA6B;AAAE,cAAA,IAAI,EAAE;AAAR,aAA7B,EAAsD,UAAA,KAAK,EAAG;AAC5D,kBAAI,KAAJ,EAAW;AACT,gBAAA,MAAM,CAAC,KAAD,CAAN;AACD;;AACD,cAAA,OAAO;AACR,aALD;AAMD,WAPM,CAHJ;;AAAA;AAcH,UAAA,OAAO,CAAC,GAAR,CACE,8HADF;AAdG;AAAA,2CAiBG,aAAA,CAAA,OAAA,CAAW,MAAX,EAAmB,OAAnB,EAA4B,YAA5B,CAjBH;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAP,OAAA,CAAA,cAAA,GAAA,cAAA","sourcesContent":["import spawnAsync, { SpawnOptions } from '@expo/spawn-async';\nimport { realpathSync } from 'fs';\nimport sudo from 'sudo-prompt';\n\nexport type Logger = (...args: any[]) => void;\n\nexport interface PackageManager {\n  installAsync(): Promise<void>;\n  addAsync(...names: string[]): Promise<void>;\n  addDevAsync(...names: string[]): Promise<void>;\n  versionAsync(): Promise<string>;\n  getConfigAsync(key: string): Promise<string>;\n  removeLockfileAsync(): Promise<void>;\n  cleanAsync(): Promise<void>;\n}\n\nexport function getPossibleProjectRoot(): string {\n  return realpathSync(process.cwd());\n}\n\nexport async function spawnSudoAsync(command: string[], spawnOptions: SpawnOptions): Promise<void> {\n  // sudo prompt only seems to work on win32 machines.\n  if (process.platform === 'win32') {\n    return new Promise((resolve, reject) => {\n      sudo.exec(command.join(' '), { name: 'pod install' }, error => {\n        if (error) {\n          reject(error);\n        }\n        resolve();\n      });\n    });\n  } else {\n    // Attempt to use sudo to run the command on Mac and Linux.\n    // TODO(Bacon): Make a v of sudo-prompt that's win32 only for better bundle size.\n    console.log(\n      'Your password might be needed to install CocoaPods CLI: https://guides.cocoapods.org/using/getting-started.html#installation'\n    );\n    await spawnAsync('sudo', command, spawnOptions);\n  }\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"script"}
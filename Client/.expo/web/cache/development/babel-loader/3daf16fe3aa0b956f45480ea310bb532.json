{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"@babel/runtime/helpers/slicedToArray\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.setProvisioningProfileForPbxproj = setProvisioningProfileForPbxproj;\n\nfunction _fsExtra() {\n  var data = _interopRequireDefault(require(\"fs-extra\"));\n\n  _fsExtra = function _fsExtra() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _Target() {\n  var data = require(\"./Target\");\n\n  _Target = function _Target() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _Xcodeproj() {\n  var data = require(\"./utils/Xcodeproj\");\n\n  _Xcodeproj = function _Xcodeproj() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction setProvisioningProfileForPbxproj(projectRoot, _ref) {\n  var targetName = _ref.targetName,\n      profileName = _ref.profileName,\n      appleTeamId = _ref.appleTeamId,\n      _ref$buildConfigurati = _ref.buildConfiguration,\n      buildConfiguration = _ref$buildConfigurati === void 0 ? 'Release' : _ref$buildConfigurati;\n  var project = (0, _Xcodeproj().getPbxproj)(projectRoot);\n  var nativeTargetEntry = targetName ? (0, _Target().findNativeTargetByName)(project, targetName) : (0, _Target().findFirstNativeTarget)(project);\n\n  var _nativeTargetEntry = _slicedToArray(nativeTargetEntry, 2),\n      nativeTargetId = _nativeTargetEntry[0],\n      nativeTarget = _nativeTargetEntry[1];\n\n  (0, _Xcodeproj().getBuildConfigurationsForListId)(project, nativeTarget.buildConfigurationList).filter(function (_ref2) {\n    var _ref3 = _slicedToArray(_ref2, 2),\n        item = _ref3[1];\n\n    return item.name === buildConfiguration;\n  }).forEach(function (_ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n        item = _ref5[1];\n\n    item.buildSettings.PROVISIONING_PROFILE_SPECIFIER = \"\\\"\" + profileName + \"\\\"\";\n    item.buildSettings.DEVELOPMENT_TEAM = appleTeamId;\n    item.buildSettings.CODE_SIGN_IDENTITY = '\"iPhone Distribution\"';\n    item.buildSettings.CODE_SIGN_STYLE = 'Manual';\n  });\n  Object.entries((0, _Xcodeproj().getProjectSection)(project)).filter(_Xcodeproj().isNotComment).forEach(function (_ref6) {\n    var _ref7 = _slicedToArray(_ref6, 2),\n        item = _ref7[1];\n\n    item.attributes.TargetAttributes[nativeTargetId].DevelopmentTeam = appleTeamId;\n    item.attributes.TargetAttributes[nativeTargetId].ProvisioningStyle = 'Manual';\n  });\n\n  _fsExtra().default.writeFileSync(project.filepath, project.writeSync());\n}","map":{"version":3,"sources":["../../src/ios/ProvisioningProfile.ts"],"names":["buildConfiguration","project","nativeTargetEntry","targetName","nativeTarget","item","Object","isNotComment","fs"],"mappings":";;;;;;;;;AAAA,SAAA,QAAA,GAAA;AAAA,MAAA,IAAA,GAAA,sBAAA,CAAA,OAAA,CAAA,UAAA,CAAA,CAAA;;AAAA,EAAA,QAAA,GAAA,oBAAA;AAAA,WAAA,IAAA;AAAA,GAAA;;AAAA,SAAA,IAAA;AAAA;;AAEA,SAAA,OAAA,GAAA;AAAA,MAAA,IAAA,GAAA,OAAA,YAAA;;AAAA,EAAA,OAAA,GAAA,mBAAA;AAAA,WAAA,IAAA;AAAA,GAAA;;AAAA,SAAA,IAAA;AAAA;;AACA,SAAA,UAAA,GAAA;AAAA,MAAA,IAAA,GAAA,OAAA,qBAAA;;AAAA,EAAA,UAAA,GAAA,sBAAA;AAAA,WAAA,IAAA;AAAA,GAAA;;AAAA,SAAA,IAAA;AAAA;;;;;;;;AAgBO,SAAA,gCAAA,CAAA,WAAA,QAQC;AAAA,MANN,UAMM,QANN,UAMM;AAAA,MANN,WAMM,QANN,WAMM;AAAA,MANN,WAMM,QANN,WAMM;AAAA,mCAFJA,kBAEI;AAAA,MAFJA,kBAEI,sCAFiB,SAEjB;AACN,MAAMC,OAAO,GAAG,CAAA,GAAA,UAAA,GAAA,UAAA,EAAhB,WAAgB,CAAhB;AAEA,MAAMC,iBAAiB,GAAGC,UAAU,GAChC,CAAA,GAAA,OAAA,GAAA,sBAAA,EAAA,OAAA,EADgC,UAChC,CADgC,GAEhC,CAAA,GAAA,OAAA,GAAA,qBAAA,EAFJ,OAEI,CAFJ;;AAGA,0CAAA,iBAAA;AAAA,MAAM,cAAN;AAAA,MAAM,YAAN;;AAEA,GAAA,GAAA,UAAA,GAAA,+BAAA,EAAA,OAAA,EAAyCC,YAAY,CAArD,sBAAA,EAAA,MAAA,CACU;AAAA;AAAA,QAAA,IAAA;;AAAA,WAAyCC,IAAI,CAAJA,IAAAA,KADnD,kBACU;AAAA,GADV,EAAA,OAAA,CAEW,iBAAyC;AAAA;AAAA,QAAzC,IAAyC;;AAChDA,IAAAA,IAAI,CAAJA,aAAAA,CAAAA,8BAAAA,UAAAA,WAAAA;AACAA,IAAAA,IAAI,CAAJA,aAAAA,CAAAA,gBAAAA,GAAAA,WAAAA;AACAA,IAAAA,IAAI,CAAJA,aAAAA,CAAAA,kBAAAA,GAAAA,uBAAAA;AACAA,IAAAA,IAAI,CAAJA,aAAAA,CAAAA,eAAAA,GAAAA,QAAAA;AANJ,GAAA;AASAC,EAAAA,MAAM,CAANA,OAAAA,CAAe,CAAA,GAAA,UAAA,GAAA,iBAAA,EAAfA,OAAe,CAAfA,EAAAA,MAAAA,CACUC,UAAAA,GADVD,YAAAA,EAAAA,OAAAA,CAEW,iBAAmC;AAAA;AAAA,QAAnC,IAAmC;;AAC1CD,IAAAA,IAAI,CAAJA,UAAAA,CAAAA,gBAAAA,CAAAA,cAAAA,EAAAA,eAAAA,GAAAA,WAAAA;AACAA,IAAAA,IAAI,CAAJA,UAAAA,CAAAA,gBAAAA,CAAAA,cAAAA,EAAAA,iBAAAA,GAAAA,QAAAA;AAJJC,GAAAA;;AAOAE,EAAAA,QAAAA,GAAAA,OAAAA,CAAAA,aAAAA,CAAiBP,OAAO,CAAxBO,QAAAA,EAAmCP,OAAO,CAA1CO,SAAmCP,EAAnCO;AACD","sourcesContent":["import fs from 'fs-extra';\n\nimport { findFirstNativeTarget, findNativeTargetByName } from './Target';\nimport {\n  ConfigurationSectionEntry,\n  getBuildConfigurationsForListId,\n  getPbxproj,\n  getProjectSection,\n  isNotComment,\n  ProjectSectionEntry,\n} from './utils/Xcodeproj';\n\ntype ProvisioningProfileSettings = {\n  targetName?: string;\n  appleTeamId: string;\n  profileName: string;\n  buildConfiguration?: string;\n};\n\nexport function setProvisioningProfileForPbxproj(\n  projectRoot: string,\n  {\n    targetName,\n    profileName,\n    appleTeamId,\n    buildConfiguration = 'Release',\n  }: ProvisioningProfileSettings\n): void {\n  const project = getPbxproj(projectRoot);\n\n  const nativeTargetEntry = targetName\n    ? findNativeTargetByName(project, targetName)\n    : findFirstNativeTarget(project);\n  const [nativeTargetId, nativeTarget] = nativeTargetEntry;\n\n  getBuildConfigurationsForListId(project, nativeTarget.buildConfigurationList)\n    .filter(([, item]: ConfigurationSectionEntry) => item.name === buildConfiguration)\n    .forEach(([, item]: ConfigurationSectionEntry) => {\n      item.buildSettings.PROVISIONING_PROFILE_SPECIFIER = `\"${profileName}\"`;\n      item.buildSettings.DEVELOPMENT_TEAM = appleTeamId;\n      item.buildSettings.CODE_SIGN_IDENTITY = '\"iPhone Distribution\"';\n      item.buildSettings.CODE_SIGN_STYLE = 'Manual';\n    });\n\n  Object.entries(getProjectSection(project))\n    .filter(isNotComment)\n    .forEach(([, item]: ProjectSectionEntry) => {\n      item.attributes.TargetAttributes[nativeTargetId].DevelopmentTeam = appleTeamId;\n      item.attributes.TargetAttributes[nativeTargetId].ProvisioningStyle = 'Manual';\n    });\n\n  fs.writeFileSync(project.filepath, project.writeSync());\n}\n"]},"metadata":{},"sourceType":"script"}